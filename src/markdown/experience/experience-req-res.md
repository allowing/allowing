# 浅谈“请求(Request)”与“响应(Response)”

上网的过程本质上是请求与响应的过程。浏览器向服务器发送请求，服务器响应请求。

## 响应的速度

在我的测试数据里一个 php 进程一秒钟可以处理 12 个请求左右，内存使用 6 兆左右，cpu 使用率 5% 左右。处理 2000 个请求耗时 156 秒，2000 个请求均成功处理。那么按照这个条件， x 个 php 进程一秒内能处理的请求数 y 存在以下关系：

```
y = 12x
```

同理，设总内存消耗量为 m，总 cpu 使用率为 c，那么 m 和 c 的函数关系式如下：

```
m = 6x
```

```
c = 5x
```

可以看到，单位时间内能处理的请求数与 php 进程数成正比，内存消耗与 cpu 消耗也成正比。

问题：求单位时间内处理 2000 个请求，需要多少个 php 进程？

解：根据函数关系式 y = 12x 得：

```
y = 12x
当 y = 2000 时：
2000 = 12x
x = 2000 / 12
x = 166.66
```

所以，要想满足条件，需要 167 个 php 进程。

那么对应的内存消耗是：6 * 167 = 1002，cpu 消耗是 5 * 167 = 835(%)

结论是，需要八核 cpu，2G 以上内存的计算机方能满足条件。

注意，上面的函数关系的系数是要根据实际情况测试出来的，我得出的系数是我用 ab 压测工具测试的，测试的是本站首页。应该多次测试，取平均值，这样得出的系数才有代表性。
